{"ast":null,"code":"var _s = $RefreshSig$();\nimport { useWeb3React } from '@web3-react/core';\nimport { useCallback, useEffect, useRef, useState } from 'react';\nexport const useRefresh = () => {\n  _s();\n  const {\n    provider\n  } = useWeb3React();\n  const [loading, setLoading] = useState(false);\n  const blockNumberRef = useRef();\n  const targetBlockNumberRef = useRef();\n  const callbackRef = useRef();\n\n  // @ts-ignore\n  useEffect(() => {\n    if (!provider) return () => undefined;\n    const listener = latestBlockNumber => {\n      try {\n        blockNumberRef.current = latestBlockNumber;\n        if (targetBlockNumberRef.current && latestBlockNumber >= targetBlockNumberRef.current) {\n          if (callbackRef.current) {\n            console.log('target block number', targetBlockNumberRef.current);\n            console.log('latest block number', latestBlockNumber);\n            callbackRef.current();\n            targetBlockNumberRef.current = undefined;\n            callbackRef.current = undefined;\n            setLoading(false);\n          }\n        }\n      } catch (error) {\n        console.error(error);\n        setLoading(false);\n      }\n    };\n    provider.on('block', listener);\n    return () => provider.removeListener('block', listener);\n  }, [provider]);\n  const subscribe = useCallback((targetBlockNumber, callbackFn) => {\n    if (blockNumberRef.current && blockNumberRef.current >= targetBlockNumber) {\n      callbackFn();\n    } else {\n      setLoading(true);\n      targetBlockNumberRef.current = targetBlockNumber;\n      callbackRef.current = callbackFn;\n    }\n  }, []);\n  return [subscribe, loading];\n};\n_s(useRefresh, \"guFHac4zbzarUtVD6WDV3wrOeck=\", false, function () {\n  return [useWeb3React];\n});","map":{"version":3,"names":["useWeb3React","useCallback","useEffect","useRef","useState","useRefresh","provider","loading","setLoading","blockNumberRef","targetBlockNumberRef","callbackRef","undefined","listener","latestBlockNumber","current","console","log","error","on","removeListener","subscribe","targetBlockNumber","callbackFn"],"sources":["/Users/hamzahmahmood/Downloads/ETHDenver/vouch-finance/vouch-finance-frontend/src/hooks/useRefresh.ts"],"sourcesContent":["import { useWeb3React } from '@web3-react/core'\nimport { useCallback, useEffect, useRef, useState } from 'react'\n\nexport const useRefresh = (): [\n  (targetBlockNumber: number, callback: () => void) => void,\n  boolean,\n] => {\n  const { provider } = useWeb3React()\n  const [loading, setLoading] = useState(false)\n  const blockNumberRef = useRef<number | undefined>()\n  const targetBlockNumberRef = useRef<number | undefined>()\n  const callbackRef = useRef<() => void | undefined>()\n\n  // @ts-ignore\n  useEffect(() => {\n    if (!provider) return () => undefined\n    const listener = (latestBlockNumber: number) => {\n      try {\n        blockNumberRef.current = latestBlockNumber\n        if (\n          targetBlockNumberRef.current &&\n          latestBlockNumber >= targetBlockNumberRef.current\n        ) {\n          if (callbackRef.current) {\n            console.log('target block number', targetBlockNumberRef.current)\n            console.log('latest block number', latestBlockNumber)\n            callbackRef.current()\n            targetBlockNumberRef.current = undefined\n            callbackRef.current = undefined\n            setLoading(false)\n          }\n        }\n      } catch (error) {\n        console.error(error)\n        setLoading(false)\n      }\n    }\n    provider.on('block', listener)\n    return () => provider.removeListener('block', listener)\n  }, [provider])\n\n  const subscribe = useCallback(\n    (targetBlockNumber: number, callbackFn: () => void) => {\n      if (\n        blockNumberRef.current &&\n        blockNumberRef.current >= targetBlockNumber\n      ) {\n        callbackFn()\n      } else {\n        setLoading(true)\n        targetBlockNumberRef.current = targetBlockNumber\n        callbackRef.current = callbackFn\n      }\n    },\n    [],\n  )\n\n  return [subscribe, loading]\n}\n"],"mappings":";AAAA,SAASA,YAAY,QAAQ,kBAAkB;AAC/C,SAASC,WAAW,EAAEC,SAAS,EAAEC,MAAM,EAAEC,QAAQ,QAAQ,OAAO;AAEhE,OAAO,MAAMC,UAAU,GAAG,MAGrB;EAAA;EACH,MAAM;IAAEC;EAAS,CAAC,GAAGN,YAAY,EAAE;EACnC,MAAM,CAACO,OAAO,EAAEC,UAAU,CAAC,GAAGJ,QAAQ,CAAC,KAAK,CAAC;EAC7C,MAAMK,cAAc,GAAGN,MAAM,EAAsB;EACnD,MAAMO,oBAAoB,GAAGP,MAAM,EAAsB;EACzD,MAAMQ,WAAW,GAAGR,MAAM,EAA0B;;EAEpD;EACAD,SAAS,CAAC,MAAM;IACd,IAAI,CAACI,QAAQ,EAAE,OAAO,MAAMM,SAAS;IACrC,MAAMC,QAAQ,GAAIC,iBAAyB,IAAK;MAC9C,IAAI;QACFL,cAAc,CAACM,OAAO,GAAGD,iBAAiB;QAC1C,IACEJ,oBAAoB,CAACK,OAAO,IAC5BD,iBAAiB,IAAIJ,oBAAoB,CAACK,OAAO,EACjD;UACA,IAAIJ,WAAW,CAACI,OAAO,EAAE;YACvBC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEP,oBAAoB,CAACK,OAAO,CAAC;YAChEC,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEH,iBAAiB,CAAC;YACrDH,WAAW,CAACI,OAAO,EAAE;YACrBL,oBAAoB,CAACK,OAAO,GAAGH,SAAS;YACxCD,WAAW,CAACI,OAAO,GAAGH,SAAS;YAC/BJ,UAAU,CAAC,KAAK,CAAC;UACnB;QACF;MACF,CAAC,CAAC,OAAOU,KAAK,EAAE;QACdF,OAAO,CAACE,KAAK,CAACA,KAAK,CAAC;QACpBV,UAAU,CAAC,KAAK,CAAC;MACnB;IACF,CAAC;IACDF,QAAQ,CAACa,EAAE,CAAC,OAAO,EAAEN,QAAQ,CAAC;IAC9B,OAAO,MAAMP,QAAQ,CAACc,cAAc,CAAC,OAAO,EAAEP,QAAQ,CAAC;EACzD,CAAC,EAAE,CAACP,QAAQ,CAAC,CAAC;EAEd,MAAMe,SAAS,GAAGpB,WAAW,CAC3B,CAACqB,iBAAyB,EAAEC,UAAsB,KAAK;IACrD,IACEd,cAAc,CAACM,OAAO,IACtBN,cAAc,CAACM,OAAO,IAAIO,iBAAiB,EAC3C;MACAC,UAAU,EAAE;IACd,CAAC,MAAM;MACLf,UAAU,CAAC,IAAI,CAAC;MAChBE,oBAAoB,CAACK,OAAO,GAAGO,iBAAiB;MAChDX,WAAW,CAACI,OAAO,GAAGQ,UAAU;IAClC;EACF,CAAC,EACD,EAAE,CACH;EAED,OAAO,CAACF,SAAS,EAAEd,OAAO,CAAC;AAC7B,CAAC;AAAA,GAvDYF,UAAU;EAAA,QAIAL,YAAY;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}