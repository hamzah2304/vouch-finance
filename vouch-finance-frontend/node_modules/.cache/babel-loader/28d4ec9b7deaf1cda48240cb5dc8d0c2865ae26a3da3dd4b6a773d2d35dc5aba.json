{"ast":null,"code":"\"use strict\";\n\n// Copyright (c) 2018-2022 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isInIFrame = exports.createQrUrl = exports.getFavicon = exports.range = exports.isBigNumber = exports.ensureParsedJSONObject = exports.ensureBN = exports.ensureRegExpString = exports.ensureIntNumber = exports.ensureBuffer = exports.ensureAddressString = exports.ensureEvenLengthHexString = exports.ensureHexString = exports.isHexString = exports.prepend0x = exports.strip0x = exports.has0xPrefix = exports.hexStringFromIntNumber = exports.intNumberFromHexString = exports.bigIntStringFromBN = exports.hexStringFromBuffer = exports.hexStringToUint8Array = exports.uint8ArrayToHex = exports.randomBytesHex = void 0;\nconst bn_js_1 = __importDefault(require(\"bn.js\"));\nconst qs_1 = require(\"qs\");\nconst types_1 = require(\"./types\");\nconst INT_STRING_REGEX = /^[0-9]*$/;\nconst HEXADECIMAL_STRING_REGEX = /^[a-f0-9]*$/;\n/**\n * @param length number of bytes\n */\nfunction randomBytesHex(length) {\n  return uint8ArrayToHex(crypto.getRandomValues(new Uint8Array(length)));\n}\nexports.randomBytesHex = randomBytesHex;\nfunction uint8ArrayToHex(value) {\n  return [...value].map(b => b.toString(16).padStart(2, \"0\")).join(\"\");\n}\nexports.uint8ArrayToHex = uint8ArrayToHex;\nfunction hexStringToUint8Array(hexString) {\n  return new Uint8Array(hexString.match(/.{1,2}/g).map(byte => parseInt(byte, 16)));\n}\nexports.hexStringToUint8Array = hexStringToUint8Array;\nfunction hexStringFromBuffer(buf) {\n  let includePrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  const hex = buf.toString(\"hex\");\n  return (0, types_1.HexString)(includePrefix ? \"0x\" + hex : hex);\n}\nexports.hexStringFromBuffer = hexStringFromBuffer;\nfunction bigIntStringFromBN(bn) {\n  return (0, types_1.BigIntString)(bn.toString(10));\n}\nexports.bigIntStringFromBN = bigIntStringFromBN;\nfunction intNumberFromHexString(hex) {\n  return (0, types_1.IntNumber)(new bn_js_1.default(ensureEvenLengthHexString(hex, false), 16).toNumber());\n}\nexports.intNumberFromHexString = intNumberFromHexString;\nfunction hexStringFromIntNumber(num) {\n  return (0, types_1.HexString)(\"0x\" + new bn_js_1.default(num).toString(16));\n}\nexports.hexStringFromIntNumber = hexStringFromIntNumber;\nfunction has0xPrefix(str) {\n  return str.startsWith(\"0x\") || str.startsWith(\"0X\");\n}\nexports.has0xPrefix = has0xPrefix;\nfunction strip0x(hex) {\n  if (has0xPrefix(hex)) {\n    return hex.slice(2);\n  }\n  return hex;\n}\nexports.strip0x = strip0x;\nfunction prepend0x(hex) {\n  if (has0xPrefix(hex)) {\n    return \"0x\" + hex.slice(2);\n  }\n  return \"0x\" + hex;\n}\nexports.prepend0x = prepend0x;\nfunction isHexString(hex) {\n  if (typeof hex !== \"string\") {\n    return false;\n  }\n  const s = strip0x(hex).toLowerCase();\n  return HEXADECIMAL_STRING_REGEX.test(s);\n}\nexports.isHexString = isHexString;\nfunction ensureHexString(hex) {\n  let includePrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  if (typeof hex === \"string\") {\n    const s = strip0x(hex).toLowerCase();\n    if (HEXADECIMAL_STRING_REGEX.test(s)) {\n      return (0, types_1.HexString)(includePrefix ? \"0x\" + s : s);\n    }\n  }\n  throw new Error(`\"${String(hex)}\" is not a hexadecimal string`);\n}\nexports.ensureHexString = ensureHexString;\nfunction ensureEvenLengthHexString(hex) {\n  let includePrefix = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n  let h = ensureHexString(hex, false);\n  if (h.length % 2 === 1) {\n    h = (0, types_1.HexString)(\"0\" + h);\n  }\n  return includePrefix ? (0, types_1.HexString)(\"0x\" + h) : h;\n}\nexports.ensureEvenLengthHexString = ensureEvenLengthHexString;\nfunction ensureAddressString(str) {\n  if (typeof str === \"string\") {\n    const s = strip0x(str).toLowerCase();\n    if (isHexString(s) && s.length === 40) {\n      return (0, types_1.AddressString)(prepend0x(s));\n    }\n  }\n  throw new Error(`Invalid Ethereum address: ${String(str)}`);\n}\nexports.ensureAddressString = ensureAddressString;\nfunction ensureBuffer(str) {\n  if (Buffer.isBuffer(str)) {\n    return str;\n  }\n  if (typeof str === \"string\") {\n    if (isHexString(str)) {\n      const s = ensureEvenLengthHexString(str, false);\n      return Buffer.from(s, \"hex\");\n    } else {\n      return Buffer.from(str, \"utf8\");\n    }\n  }\n  throw new Error(`Not binary data: ${String(str)}`);\n}\nexports.ensureBuffer = ensureBuffer;\nfunction ensureIntNumber(num) {\n  if (typeof num === \"number\" && Number.isInteger(num)) {\n    return (0, types_1.IntNumber)(num);\n  }\n  if (typeof num === \"string\") {\n    if (INT_STRING_REGEX.test(num)) {\n      return (0, types_1.IntNumber)(Number(num));\n    }\n    if (isHexString(num)) {\n      return (0, types_1.IntNumber)(new bn_js_1.default(ensureEvenLengthHexString(num, false), 16).toNumber());\n    }\n  }\n  throw new Error(`Not an integer: ${String(num)}`);\n}\nexports.ensureIntNumber = ensureIntNumber;\nfunction ensureRegExpString(regExp) {\n  if (regExp instanceof RegExp) {\n    return (0, types_1.RegExpString)(regExp.toString());\n  }\n  throw new Error(`Not a RegExp: ${String(regExp)}`);\n}\nexports.ensureRegExpString = ensureRegExpString;\nfunction ensureBN(val) {\n  if (val !== null && (bn_js_1.default.isBN(val) || isBigNumber(val))) {\n    return new bn_js_1.default(val.toString(10), 10);\n  }\n  if (typeof val === \"number\") {\n    return new bn_js_1.default(ensureIntNumber(val));\n  }\n  if (typeof val === \"string\") {\n    if (INT_STRING_REGEX.test(val)) {\n      return new bn_js_1.default(val, 10);\n    }\n    if (isHexString(val)) {\n      return new bn_js_1.default(ensureEvenLengthHexString(val, false), 16);\n    }\n  }\n  throw new Error(`Not an integer: ${String(val)}`);\n}\nexports.ensureBN = ensureBN;\nfunction ensureParsedJSONObject(val) {\n  if (typeof val === \"string\") {\n    return JSON.parse(val);\n  }\n  if (typeof val === \"object\") {\n    return val;\n  }\n  throw new Error(`Not a JSON string or an object: ${String(val)}`);\n}\nexports.ensureParsedJSONObject = ensureParsedJSONObject;\nfunction isBigNumber(val) {\n  if (val == null || typeof val.constructor !== \"function\") {\n    return false;\n  }\n  const {\n    constructor\n  } = val;\n  return typeof constructor.config === \"function\" && typeof constructor.EUCLID === \"number\";\n}\nexports.isBigNumber = isBigNumber;\nfunction range(start, stop) {\n  return Array.from({\n    length: stop - start\n  }, (_, i) => start + i);\n}\nexports.range = range;\nfunction getFavicon() {\n  const el = document.querySelector('link[sizes=\"192x192\"]') || document.querySelector('link[sizes=\"180x180\"]') || document.querySelector('link[rel=\"icon\"]') || document.querySelector('link[rel=\"shortcut icon\"]');\n  const {\n    protocol,\n    host\n  } = document.location;\n  const href = el ? el.getAttribute(\"href\") : null;\n  if (!href || href.startsWith(\"javascript:\")) {\n    return null;\n  }\n  if (href.startsWith(\"http://\") || href.startsWith(\"https://\") || href.startsWith(\"data:\")) {\n    return href;\n  }\n  if (href.startsWith(\"//\")) {\n    return protocol + href;\n  }\n  return `${protocol}//${host}${href}`;\n}\nexports.getFavicon = getFavicon;\nfunction createQrUrl(sessionId, sessionSecret, serverUrl, isParentConnection, version, chainId) {\n  const sessionIdKey = isParentConnection ? \"parent-id\" : \"id\";\n  const query = (0, qs_1.stringify)({\n    [sessionIdKey]: sessionId,\n    secret: sessionSecret,\n    server: serverUrl,\n    v: version,\n    chainId\n  });\n  const qrUrl = `${serverUrl}/#/link?${query}`;\n  return qrUrl;\n}\nexports.createQrUrl = createQrUrl;\nfunction isInIFrame() {\n  try {\n    return window.frameElement !== null;\n  } catch (e) {\n    return false;\n  }\n}\nexports.isInIFrame = isInIFrame;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}